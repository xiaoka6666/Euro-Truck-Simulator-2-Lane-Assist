<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:views="clr-namespace:ETS2LA.UI.Views.Settings"
             xmlns:husk="https://github.com/d3ara1n/Huskui.Avalonia"
             x:Class="ETS2LA.UI.Views.Settings.ControlSettings"
             x:DataType="views:ControlSettings">

    <UserControl.Resources>
        <ItemsPanelTemplate x:Key="WrapPanelTemplate">
            <StackPanel />
        </ItemsPanelTemplate>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel>
            <TextBlock Text="点击卡片更改绑定。右键点击'普通轴'以更改其类型。" Classes="Description" Margin="14 7 14 7" />
            <ItemsControl x:Name="ControlsList" ItemsSource="{Binding Controls}" ItemsPanel="{StaticResource WrapPanelTemplate}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="views:ControlItem">
                        <husk:Card 
                            Padding="0 14 0 0"
                            Margin="10"
                            HorizontalAlignment="Stretch"
                            ClipToBounds="True"
                            Tag="{Binding}"
                            Cursor="Hand"
                            Classes.Highlight="{Binding IsActive}"
                            PointerPressed="OnTriggerChange"
                        >
                            <StackPanel>
                                <Grid ColumnDefinitions="*, Auto" ColumnSpacing="6" Margin="14 0 14 0">
                                    <StackPanel Spacing="6">
                                        <TextBlock Text="{Binding Name}" FontSize="14" />
                                        <TextBlock Text="{Binding Description}" Classes="Description" FontSize="12" Padding="0 0 0 4" />
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Spacing="6" HorizontalAlignment="Right" VerticalAlignment="Top">
                                        <husk:Tag Classes="Secondary" HorizontalAlignment="Right">
                                            <TextBlock Text="{Binding DeviceName}" FontSize="12" FontWeight="450" />
                                        </husk:Tag>
                                        <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Right">
                                            <husk:Tag Classes="Primary">
                                                <TextBlock Text="{Binding DeviceButtonType}" FontSize="12" FontWeight="450" />
                                                <husk:Tag.ContextMenu>
                                                    <!-- TODO: Someone who knows more about Avalonia can fix this... -->
                                                    <ContextMenu>
                                                        <MenuItem Header="普通" Click="OnAxisTypeNormalClick" Tag="{Binding}" />
                                                        <MenuItem Header="居中" Click="OnAxisTypeCenteredClick" Tag="{Binding}" />
                                                        <MenuItem Header="反转" Click="OnAxisTypeInvertedClick" Tag="{Binding}" />
                                                        <MenuItem Header="分割负值" Click="OnAxisTypeSplitNegativeClick" Tag="{Binding}" />
                                                        <MenuItem Header="分割正值" Click="OnAxisTypeSplitPositiveClick" Tag="{Binding}" />
                                                    </ContextMenu>
                                                </husk:Tag.ContextMenu>
                                            </husk:Tag>
                                            <husk:Tag Classes="Primary">
                                                <TextBlock Text="{Binding DeviceButton}" FontSize="12" FontWeight="450" />
                                            </husk:Tag>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                                <Border ClipToBounds="True" CornerRadius="0 0 8 8">
                                    <ProgressBar Value="{Binding CurrentValue}" Classes="Transparent" Height="1" Margin="0 7 0 0" />
                                </Border>
                            </StackPanel>
                        </husk:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </ScrollViewer>
</UserControl>